# MITRE ATT&CK Classifier Configuration

# Data Configuration
data:
  num_samples: 50000
  techniques_count: 50
  test_split: 0.2
  random_seed: 42
  
  output_path: "data/raw/attack_logs.json"
  processed_path: "data/processed/features.parquet"
  
  # MITRE ATT&CK mapping
  mitre_mapping_path: "data/mitre_attack_mapping.json"
  
  # Attack simulation parameters
  simulation:
    min_techniques_per_attack: 1
    max_techniques_per_attack: 5
    noise_ratio: 0.05

# Feature Engineering Configuration
features:
  vectorizer: "tfidf"
  max_features: 5000
  ngram_range: [1, 3]
  min_df: 2
  max_df: 0.95
  
  # Text fields to vectorize
  text_fields:
    - "action"
    - "command"
    - "process"
    - "file_path"
  
  # Categorical features
  categorical_features:
    - "protocol"
    - "port"
    - "user_type"
  
  # Numerical features
  numerical_features:
    - "bytes_transferred"
    - "connection_count"
    - "failed_attempts"

# Model Configuration
models:
  model_dir: "models/saved_models"
  default_model: "ensemble"
  
  # Random Forest Multi-Label Classifier
  random_forest:
    n_estimators: 200
    max_depth: 20
    min_samples_split: 5
    min_samples_leaf: 2
    max_features: "sqrt"
    n_jobs: -1
    random_state: 42
  
  # Neural Network Classifier
  neural_network:
    hidden_layers: [256, 128, 64]
    activation: "relu"
    dropout: 0.3
    batch_size: 64
    epochs: 50
    learning_rate: 0.001
    early_stopping_patience: 5
  
  # Ensemble Configuration
  ensemble:
    method: "voting"  # voting, stacking
    models:
      - "random_forest"
      - "neural_network"
    weights:
      random_forest: 0.6
      neural_network: 0.4

# Multi-Label Strategy
multilabel:
  strategy: "binary_relevance"  # binary_relevance, classifier_chains, label_powerset
  threshold: 0.5

# API Configuration
api:
  host: "0.0.0.0"
  port: 8000
  workers: 4
  reload: false
  
  # Authentication
  auth:
    enabled: false
    api_key_header: "X-API-Key"
  
  # Rate Limiting
  rate_limit:
    enabled: true
    requests_per_minute: 60
  
  # CORS
  cors:
    enabled: true
    origins:
      - "http://localhost:3000"
      - "http://localhost:8080"
  
  # Caching
  cache:
    enabled: true
    ttl: 300  # seconds
    backend: "memory"  # memory, redis

# Evaluation Configuration
evaluation:
  metrics:
    - "hamming_loss"
    - "subset_accuracy"
    - "f1_micro"
    - "f1_macro"
    - "f1_weighted"
    - "precision_micro"
    - "recall_micro"
  
  # Per-technique metrics
  per_technique_metrics: true
  
  # Confusion matrix
  generate_confusion_matrix: true

# Logging Configuration
logging:
  level: "INFO"
  format: "{time} | {level} | {message}"
  rotation: "500 MB"
  retention: "30 days"
  
  # API request logging
  log_requests: true
  log_predictions: true

# Monitoring Configuration
monitoring:
  enabled: true
  prometheus_port: 9090
  
  # Metrics to track
  track_metrics:
    - "prediction_latency"
    - "model_accuracy"
    - "api_requests"
    - "error_rate"

# MITRE ATT&CK Configuration
mitre:
  # Tactics to include
  tactics:
    - "reconnaissance"
    - "resource-development"
    - "initial-access"
    - "execution"
    - "persistence"
    - "privilege-escalation"
    - "defense-evasion"
    - "credential-access"
    - "discovery"
    - "lateral-movement"
    - "collection"
    - "command-and-control"
    - "exfiltration"
    - "impact"
  
  # Minimum confidence threshold for predictions
  confidence_threshold: 0.3
  
  # Maximum techniques to return per prediction
  max_techniques_per_prediction: 10
